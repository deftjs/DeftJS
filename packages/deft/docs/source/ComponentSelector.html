<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">// Generated by CoffeeScript 1.6.2
/*
Copyright (c) 2012 [DeftJS Framework Contributors](http://deftjs.org)
Open source under the [MIT License](http://en.wikipedia.org/wiki/MIT_License).
*/

<span id='Deft-mvc-ComponentSelector'>/**
</span>* @private
* Models a component selector used by Deft.mvc.ViewController to locate view components and attach event listeners.
*/
Ext.define('Deft.mvc.ComponentSelector', {
  requires: ['Ext.ComponentQuery', 'Deft.log.Logger', 'Deft.mvc.ComponentSelectorListener'],
<span id='Deft-mvc-ComponentSelector-method-constructor'>  constructor: function(config) {
</span>    var eventName, fn, listener, options, scope, _ref;

    Ext.apply(this, config);
    if (!this.live) {
      this.components = this.selector != null ? Ext.ComponentQuery.query(this.selector, this.view) : [this.view];
    }
    this.selectorListeners = [];
    if (Ext.isObject(this.listeners)) {
      _ref = this.listeners;
      for (eventName in _ref) {
        listener = _ref[eventName];
        fn = listener;
        scope = this.scope;
        options = null;
        if (Ext.isObject(listener)) {
          options = Ext.apply({}, listener);
          if (options.fn != null) {
            fn = options.fn;
            delete options.fn;
          }
          if (options.scope != null) {
            scope = options.scope;
            delete options.scope;
          }
        }
        if (Ext.isString(fn) &amp;&amp; Ext.isFunction(scope[fn])) {
          fn = scope[fn];
        }
        if (!Ext.isFunction(fn)) {
          Ext.Error.raise({
            msg: &quot;Error adding '&quot; + eventName + &quot;' listener: the specified handler '&quot; + fn + &quot;' is not a Function or does not exist.&quot;
          });
        }
        this.addListener(eventName, fn, scope, options);
      }
    }
    return this;
  },
<span id='Deft-mvc-ComponentSelector-method-destroy'>  destroy: function() {
</span>    var selectorListener, _i, _len, _ref;

    _ref = this.selectorListeners;
    for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
      selectorListener = _ref[_i];
      selectorListener.destroy();
    }
    this.selectorListeners = [];
  },
<span id='Deft-mvc-ComponentSelector-method-addListener'>  /**
</span>  	Add an event listener to this component selector.
  */

  addListener: function(eventName, fn, scope, options) {
    var selectorListener;

    if (this.findListener(eventName, fn, scope) != null) {
      Ext.Error.raise({
        msg: &quot;Error adding '&quot; + eventName + &quot;' listener: an existing listener for the specified function was already registered for '&quot; + this.selector + &quot;.&quot;
      });
    }
    Deft.Logger.log(&quot;Adding '&quot; + eventName + &quot;' listener to '&quot; + this.selector + &quot;'.&quot;);
    selectorListener = Ext.create('Deft.mvc.ComponentSelectorListener', {
      componentSelector: this,
      eventName: eventName,
      fn: fn,
      scope: scope,
      options: options
    });
    this.selectorListeners.push(selectorListener);
  },
<span id='Deft-mvc-ComponentSelector-method-removeListener'>  /**
</span>  	Remove an event listener from this component selector.
  */

  removeListener: function(eventName, fn, scope) {
    var selectorListener;

    selectorListener = this.findListener(eventName, fn, scope);
    if (selectorListener != null) {
      Deft.Logger.log(&quot;Removing '&quot; + eventName + &quot;' listener from '&quot; + this.selector + &quot;'.&quot;);
      selectorListener.destroy();
      Ext.Array.remove(this.selectorListeners, selectorListener);
    }
  },
<span id='Deft-mvc-ComponentSelector-method-findListener'>  findListener: function(eventName, fn, scope) {
</span>    var selectorListener, _i, _len, _ref;

    _ref = this.selectorListeners;
    for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
      selectorListener = _ref[_i];
      if (selectorListener.eventName === eventName &amp;&amp; selectorListener.fn === fn &amp;&amp; selectorListener.scope === scope) {
        return selectorListener;
      }
    }
    return null;
  }
});
</pre>
</body>
</html>
